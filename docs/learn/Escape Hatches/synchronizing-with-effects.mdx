# effect 를 동기화하기

몇 컴포넌트들은 외부 시스템과 동기화할 필요가 있습니다. 예를 들어, React 상태에 기반한 React가 아닌 컴포넌트를 제어하거나, 서버 연결을 설정하거나, 화면에 컴포넌트나 나타날 때 분석 로그를 보내고 싶을 수 있습니다.
*Effects*는 렌더링 후에 코드를 실행해서 React 밖의 시스템과 컴포넌트를 동기화할 수 있습니다.

:::info 여러분이 배울 것
- Effects가 무엇인지
- Effects가 이벤트와 어떻게 다른지
- 컴포넌트 내부에 Effect를 선언하는 방법
- 불필요하게 Effects를 재실행하는 것을 건너뛰는 방법
- 개발에서 Effects가 두 번 실행되는 이유와 그것을 고치는 방법 
:::

## Effects는 무엇이고 이벤트와 어떻게 다를까요?

Effects로 들어가기 전에, React 컴포넌트 안의 두 가지 로직와 친숙해야 할 필요가 있습니다:

- **코드 렌더링**([UI 묘사하기](https://beta.reactjs.org/learn/describing-the-ui)에서 소개된)은 컴포넌트의 상위 레벨에 위치합니다.
prop과 상태를 받고 변형시킨 다음에 화면에서 볼 수 있도록 JSX를 반환하는 곳입니다.
[코드를 렌더링하는 것은 반드시 순수해야 합니다.](https://beta.reactjs.org/learn/keeping-components-pure)
수학 공식 처럼, 결과만을 계산하고 다른 어떤 것도 해서는 안됩니다.

- **이벤트 핸들러**([인터랙티비티 추가하기](https://beta.reactjs.org/learn/adding-interactivity)에서 소개된)는
컴포넌트 내에서 그냥 계산하는 것 이외의 것들을 하는 중첩된 함수입니다. 
이벤트 핸들러는 입력 필드를 업데이터하고, 제품을 사서 HTTP POST 요청을 보내거나 다른 화면로 사용자를 이끌 수 있습니다. 
이벤트 핸들러는 (프로그램의 상태에 따라 바뀌는)"[부작용](https://en.wikipedia.org/wiki/Side_effect_(computer_science))"
이 있고 특정한 사용자의 행동으로 일어납니다(예를 들어, 버튼을 클릭하거나 타이핑하는 것).

때떄로 이것만으로는 충분하지 않습니다. 스크린에 보일 떄마다 채팅 서버에 연결하는 `ChatRoom` 컴포넌트를 고려해보세요. 
서버에 연결하는 것은 순수한 계산이 아니기 떄문에 (부작용) 렌더링 동안에는 일어날 수 없습니다. 
그러나, 클릭 한 번으로 인해 채팅룸이 표시되는 특정 이벤트는 없습니다.

**Effect를 사용하면 특정 이벤트를 사용하는 것 이외에 렌더링으로 일어나는 부작용을 명시할 수 있습니다.**
채팅룸 안에서 메세지를 보내는 것은 특정 버튼을 클릭해서 사용자가 일으키기 떄문에 _이벤트_입니다.
그러나, 서버 연결을 설정하는 것은 컴포넌트가 보이도록 하는 인터랙션과 무관하게 일어날 필요가 있기 때문에 _Effect_입니다.
Effect는 화면 업데이트 후에 [렌더링 과정](rendering process)의 끝에 일어납니다.
React 컴포넌트와 다른 외부 시스템(네트워크나 다른 라이브러리)을 동기화하기에 적기입니다.

:::note note
이 텍스트에서 대문자 "Effect"는 위에서 설명한 React에 한정된 정의를 의미합니다. 예시: 렌더링에서 발생한 부작용(side effect).
더 넓은 프로그래밍 개념을 가리키기 위해서는 "부작용"이라고 부를 것입니다.
:::

## Effect가 필요 없을 수도 있습니다.

**컴포넌트에 급하게 Effect를 추가하지 마세요.** Effect는 보통 React 코드의 "단계에서 벗어나고" 외부 시스템과 동기화하기 위해 사용된다는 것을 유념하세요.
이는 브라우저 API, 위젯, 네트워크 등등을 포함합니다. Effect가 다른 상테에 의존하는 어떤 상태를 조정한다면, [Effect가 필요 없을 수 있습니다.](https://beta.reactjs.org/learn/you-might-not-need-an-effect)

## Effect를 작성하는 방법

Effect를 작성하기 위해서는 다음 세 단계를 따르세요:

1. **Effect를 선언하세요.** 기본적으로 Effect는 렌더링 다음에 일어납니다.
2. **Effect 의존도를 명시하세요.** 대부분의 Effect는 모든 렌더링 후에 일어나기 보다 _필요한_ 시점 이후에 다시 싱행되어야 합니다.
예를 들어, fade-in 애니메이션은 컴포넌트가 나타날 때에만 작동해야 합니다. 
채팅방을 연결하고 끊는 것은 컴포넌트가 나타나고 사라질 때만 일어나거나, 채링방이 변할 때만 일어나야 하니다. 
이것을 의존성을 명시해서 조절하는 방법을 배울 것입니다.

2. **필요하면 치우는 과정을 추가하세요.** 어떤 이펙트들은 작동할 때마다 멈추고, 되돌리고, 지우는 방법을 명시할 필요가 있습니다/
예를 들어, "연결"은 "연결해제"가 필요하고, "구독"은 "구독 해지"가 필요하고, "새로 고침"은 "취소나 "무시"가 필요합니다. _지움_함수를 반환해서 이러한 작업을 하는 방법을 배울 것입니다.

## 1단계: Effect를 선언하세요.

컴포넌트 안에 Effect를 선언하기 위해서는 React에서 `[useEffect 훅](https://beta.reactjs.org/reference/react/useEffect)`을 임포트해야 합니다.

```js
 import { useEffect } from 'react';
```

그리고 나서, 컴포넌트의 최상단에서 호출하고 Effect 안에 코드를 작성하세요:

```js 
function MyComponent() {
  useEffect(() => {
    // Code here will run after *every* render
  });
  return <div />;
}
```
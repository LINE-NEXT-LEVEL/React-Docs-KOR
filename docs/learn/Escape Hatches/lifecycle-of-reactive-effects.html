<!doctype html>
<html lang="ko" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-learn/Escape Hatches/lifecycle-of-reactive-effects">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">React적인 Effect의 생명주기 | React Docs KOR</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://line-next-level.github.io/React-Docs-KOR/docs/learn/Escape Hatches/lifecycle-of-reactive-effects"><meta data-rh="true" name="docusaurus_locale" content="ko"><meta data-rh="true" name="docsearch:language" content="ko"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="React적인 Effect의 생명주기 | React Docs KOR"><meta data-rh="true" name="description" content="Effect는 컴포넌트와 다른 생명 주기를 갖고 있습니다."><meta data-rh="true" property="og:description" content="Effect는 컴포넌트와 다른 생명 주기를 갖고 있습니다."><link data-rh="true" rel="icon" href="/React-Docs-KOR/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://line-next-level.github.io/React-Docs-KOR/docs/learn/Escape Hatches/lifecycle-of-reactive-effects"><link data-rh="true" rel="alternate" href="https://line-next-level.github.io/React-Docs-KOR/docs/learn/Escape Hatches/lifecycle-of-reactive-effects" hreflang="ko"><link data-rh="true" rel="alternate" href="https://line-next-level.github.io/React-Docs-KOR/docs/learn/Escape Hatches/lifecycle-of-reactive-effects" hreflang="x-default"><link rel="stylesheet" href="/React-Docs-KOR/assets/css/styles.96f2dfcc.css">
<link rel="preload" href="/React-Docs-KOR/assets/js/runtime~main.e4fc62bc.js" as="script">
<link rel="preload" href="/React-Docs-KOR/assets/js/main.e1e3cefa.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="본문으로 건너뛰기"><a href="#" class="skipToContent_fXgn">본문으로 건너뛰기</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/React-Docs-KOR/"><div class="navbar__logo"><img src="/React-Docs-KOR/img/logo.svg" alt="React Docs Beta KOR" class="themedImage_ToTc themedImage--light_HNdA"><img src="/React-Docs-KOR/img/logo.svg" alt="React Docs Beta KOR" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">React Docs Beta KOR</b></a><a class="navbar__item navbar__link" href="/React-Docs-KOR/docs/learn/installation/add-react-to-website">learn</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="어두운 모드와 밝은 모드 전환하기 (현재 밝은 모드)" aria-label="어두운 모드와 밝은 모드 전환하기 (현재 밝은 모드)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="맨 위로 스크롤하기" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/React-Docs-KOR/docs/category/learn">Learn</a><button aria-label="접을 수 있는 사이드바 분류 &#x27;Learn&#x27; 접기(펼치기)" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/React-Docs-KOR/docs/category/managing-state">Managing State</a><button aria-label="접을 수 있는 사이드바 분류 &#x27;Managing State&#x27; 접기(펼치기)" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/React-Docs-KOR/docs/category/installation">Installation</a><button aria-label="접을 수 있는 사이드바 분류 &#x27;Installation&#x27; 접기(펼치기)" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/React-Docs-KOR/docs/category/describing-the-ui">Describing the UI</a><button aria-label="접을 수 있는 사이드바 분류 &#x27;Describing the UI&#x27; 접기(펼치기)" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/React-Docs-KOR/docs/learn/Adding Interactivity/adding-interactivity">Adding Interactivity</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/React-Docs-KOR/docs/learn/Escape Hatches/escape-hatches">Escape Hatches</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/React-Docs-KOR/docs/learn/Escape Hatches/escape-hatches">탈출구 (Advanced)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/React-Docs-KOR/docs/learn/Escape Hatches/lifecycle-of-reactive-effects">React적인 Effect의 생명주기</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/React-Docs-KOR/docs/learn/Escape Hatches/manipulating-the-dom-with-refs">manipulating-the-dom-with-refs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/React-Docs-KOR/docs/learn/Escape Hatches/manipulating-the-doms-with-refs">manipulating-the-doms-with-refs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/React-Docs-KOR/docs/learn/Escape Hatches/referencing-values-with-refs">Ref를 이용해 값을 기억하기</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/React-Docs-KOR/docs/learn/Escape Hatches/removing-effect-dependencies">Effect 의존성을 제거하기</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/React-Docs-KOR/docs/learn/Escape Hatches/reusing-logic-with-custom-hooks">커스텀 훅으로 로직 재사용하기</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/React-Docs-KOR/docs/learn/Escape Hatches/seperating-events-from-effects">Effects에서 이벤트 분리하기</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/React-Docs-KOR/docs/learn/Escape Hatches/synchronizing-with-effects">synchronizing-with-effects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/React-Docs-KOR/docs/learn/Escape Hatches/you-might-not-need-an-effect">Effect가 필요하지 않을 수 있습니다.</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/React-Docs-KOR/docs/learn/Quick-Start/thinking-in-react">Quick-Start</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/React-Docs-KOR/docs/Installation/editor-setup">Installation</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="홈" class="breadcrumbs__link" href="/React-Docs-KOR/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/React-Docs-KOR/docs/category/learn"><span itemprop="name">Learn</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Escape Hatches</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">React적인 Effect의 생명주기</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">이 페이지에서</button></div><div class="theme-doc-markdown markdown"><h1>React적인 Effect의 생명주기</h1><p>Effect는 컴포넌트와 다른 생명 주기를 갖고 있습니다.
컴포넌트는 마운트하고, 업데이트하고, 언마운트합니다.
Effect는 단지 무언가와 동기화하거나, 동기화하는 것을 후에 멈추는 것 이 두가지 일만 할 수 있습니다
만약 여러분의 Effect가 시간이 지나 변하는 prop과 상태에 의존한다면 이 주기는 여러번 일어납니다.
React는 Effect 의존성을 올바르게 작성했는지 검사하는 linter 규칙을 제공합니다.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>여러분이 배울 것</div><div class="admonitionContent_S0QG"><ul><li>Effect의 생명주기와 컴포넌트의 생명주기의 차이</li><li>각각의 Effect를 독립적으로 생각해 보기</li><li>Effect가 재동기화가 필요한 떄와 이유</li><li>Effect의 의존성이 결정되는 방법</li><li>값이 React스럽다는 의미 </li><li>빈 의존성 배열이 의미하는 것</li><li>React가 linter를 이용해 의존성이 정확한지 확인하는 법</li><li>linter와 여러분의 의견이 다를 때 할 수 있는 일</li></ul></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="effect의-생명주기">Effect의 생명주기<a class="hash-link" href="#effect의-생명주기" title="제목으로 바로 가기">​</a></h2><p>모든 React 컴포넌트는 같은 생명주기를 거칩니다.</p><ul><li>컴포넌트는 화면에 추가될 때 <em>마운트</em>합니다.</li><li>컴포넌트는 새로운 prop 또는 상태를 받을 때 <em>업데이트</em>합니다. 보통 상호작용에 대한 반응으로 일어납니다.</li><li>컴포넌트는 화면에서 제거될 때 <em>언마운트</em>합니다.</li></ul><p><strong>컴포넌트에 대해 고민하는 것은 좋은 방식이지만 Effect는 <em>아닙니다.</em></strong>
대신에 각 Effect가 컴포넌트의 생명주기에서 독립적이라는 것을 생각해 보세요.
Effect는 현재 prop과 상태를 <a href="https://beta.reactjs.org/learn/lifecycle-of-reactive-effects" target="_blank" rel="noopener noreferrer">외부 시스템과 동기화</a>하는 법을 알려줍니다.
코드가 변경될 때마다, 이 동기화는 거의 항상 일어나야 합니다.</p><p>이 부분을 설명하기 위해서 컴포넌트를 챗 서버와 연결하는 아래 Effect로 생각해 봅시다.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> serverUrl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;https://localhost:1234&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> roomId </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">disconnect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">roomId</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Effect 내부 코드는 <strong>동기화를 시작</strong>하는 법을 나타내고 있습니다.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">disconnect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Effect에서 반환되는 제거함수는 <strong>동기화를 멈출</strong> 방법을 나타냅니다.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">disconnect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>직관적으로 React가 컴포넌트가 마운트할 때 <strong>동기화를 시작</strong>하고 컴포넌트가 언마운트할 때 <strong>동기화를 멈추</strong>도록 하면 된다고 생각할지도 모릅니다.
하지만, 이게 다가 아닙니다!
가끔 컴포넌트가 마운트되어 있는 상태에서 <strong>동기화가 여러번 시작되고 멈추</strong>어야 하는 경우도 있습니다.</p><p><em>왜</em> 이것이 필요하고, <em>언제</em> 이것이 일어나며 <em>어떻게</em> 여러분이 이 상황을 통제할 수 있는지 살펴봅시다.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>노트</div><div class="admonitionContent_S0QG"><p>몇몇 Effect는 제거함수를 전혀 반환하지 않습니다.
<a href="https://beta.reactjs.org/learn/synchronizing-with-effects#how-to-handle-the-effect-firing-twice-in-development" target="_blank" rel="noopener noreferrer">보통</a>, 여러분은 제거함수를 반환해야 합니다.
하지만 반환하지 않다 하더라도 React는 아무것도 하지 않는 빈 제거함수를 반환했다고 여기고 행동합니다. </p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="왜-동기화는-1번-이상-일어날-필요가-있을까">왜 동기화는 1번 이상 일어날 필요가 있을까<a class="hash-link" href="#왜-동기화는-1번-이상-일어날-필요가-있을까" title="제목으로 바로 가기">​</a></h3><p>드롭다운에서 사용자가 선택한 <code>roomId</code> prop을 받는 <code>ChatRoom</code> 컴포넌트를 상상해 보세요.
초기에 사용자가 <code>&quot;general&quot;</code> 방을 <code>roomId</code>로 선택했다고 해봅시다.
여러분의 앱은 <code>&quot;general&quot;</code> 챗 방을 보여줍니다.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> serverUrl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;https://localhost:1234&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> roomId </span><span class="token comment" style="color:#999988;font-style:italic">/* &quot;general&quot; */</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">h1</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token maybe-class-name">Welcome</span><span class="token plain"> to the </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">roomId</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> room</span><span class="token operator" style="color:#393A34">!</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">h1</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>UI가 보여진 후, React는 <strong>동기화를 시작</strong>하기 위해 Effect를 실행할 것입니다.
<code>&quot;general&quot;</code> 방과 연결되었습니다.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> roomId </span><span class="token comment" style="color:#999988;font-style:italic">/* &quot;general&quot; */</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;general&quot; 방과 연결합니다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">disconnect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;general&quot; 방과 연결을 끊습니다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">roomId</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>아직 까지는 잘 되고 있습니다.
이후 사용자가 드롭다운에서 다른 방을 선택합니다(예를 들어, <code>&quot;travel&quot;</code>). React는 가장 먼저 UI를 업데이트합니다:</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> roomId </span><span class="token comment" style="color:#999988;font-style:italic">/* &quot;travel&quot; */</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">h1</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token maybe-class-name">Welcome</span><span class="token plain"> to the </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">roomId</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> room</span><span class="token operator" style="color:#393A34">!</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">h1</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>다음에 무슨 일이 일어날지 생각하는 것을 멈추세요.
사용자는 UI에서 <code>&quot;travel&quot;</code>이 선택된 챗 방이라는 것을 볼 것입니다.
하지만, 마지막으로 실행되는 Effect는 여전히 <code>&quot;general&quot;</code> 방에 연결되어 있습니다.
<code>&quot;roomId&quot;</code>prop은 변화했고 Effect가 이전에 한 일(<code>&quot;general&quot;</code> 방과의 연결)은 UI와 더이상 맞지 않습니다.</p><p>이 지점에서 여러분은 React가 두가지 일을 하기를 바랍니다.</p><ol><li>오래된 <code>roomId</code>와의 동기화를 멈추는 것 (<code>&quot;general&quot;</code> 방과 연결을 끊기)</li><li>새로운 <code>roomId</code>와의 동기화를 시작하는 것 (<code>&quot;travel&quot;</code> 방과 연결)</li></ol><p><strong>다행히도 여러분은 React가 두가지 일을 하는 방법을 이미 알고 있습니다!</strong>
Effect 내부의 코드는 동기화를 시작하는 법을 나타내고 제거함수는 동기화를 멈추는 법을 나타냅니다.
React가 이제 해야 할 일은 올바른 순서와 올바른 prop과 상태로 이들을 부르는 것입니다.
얼마나 정확히 실행되는지 살펴봅시다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="react가-effect를-재동기화하는-법">React가 Effect를 재동기화하는 법<a class="hash-link" href="#react가-effect를-재동기화하는-법" title="제목으로 바로 가기">​</a></h3><p><code>ChatRoom</code> 컴포넌트가 <code>roomId</code> prop으로 새로운 값을 받았다는 것을 상기해 봅시다.
<code>roomId</code>는 <code>&quot;general&quot;</code>이었고 현재는 <code>&quot;travel&quot;</code> 입니다.
React는 다른 방을 재연결하기 위해 Effect를 재동기화할 필요가 있습니다.</p><p><strong>동기화를 멈추기 위해서</strong> React는 <code>&quot;general&quot;</code> 방과의 연결 이후 Effect가 반환했던 제거함수를 실행할 것입니다.
<code>roomId</code>가 <code>&quot;general&quot;</code>이었기 때문에 제거함수는 <code>&quot;general&quot;</code> 방과의 연결을 끊습니다.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> roomId </span><span class="token comment" style="color:#999988;font-style:italic">/* &quot;general&quot; */</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;general&quot; 방과 연결</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">disconnect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;general&quot; 방과의 연결 끊기</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>React는 렌더링 동안 구성한 Effect를 실행할 것입니다.
이번에는, <code>roomId</code>는 <code>&quot;travel&quot;</code>이므로 Effect는 <code>&quot;travel&quot;</code> 챗 방과의 동기화를 시작할 것입니다(Effect의 제거함수가 실행되기 전까지).</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> roomId </span><span class="token comment" style="color:#999988;font-style:italic">/* &quot;travel&quot; */</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// &quot;travel&quot; 방과 연결</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>다행스럽게도 이제 여러분은 사용자가 UI에서 선택한 방과 같은 방을 연결했습니다.
재앙을 막았습니다!</p><p>컴포넌트가 다른 <code>roomId</code>로 재렌더링될때마다 Effect는 재동기화할 것입니다.
예를 들어, 사용자가 <code>roomId</code>를 <code>&quot;travel&quot;</code>에서 <code>&quot;music&quot;</code>으로 바꾸었다고 해봅시다.
React는 제거함수(<code>&quot;travel&quot;</code> 방에서 연결을 끊는 것) 를 부름으로서 Effect <strong>동기화를 다시 막을</strong> 것입니다.
그리고 나서 React는 새로운 <code>roomId</code> prop을 가지고 Effect 내부의 코드를 실행하여 <strong>동기화를 시작</strong>(<code>&quot;music&quot;</code> 방으로 연결하는 것) 할 것입니다.</p><p>마침내, 사용자가 다른 화면으로 갈 때, <code>ChatRoom</code>은 언마운트됩니다.
이제 아무것도 연결될 필요가 없습니다.
React는 마지막 Effect <strong>동기화를 막고</strong> <code>&quot;music&quot;</code> 챗 방과의 연결을 끊을 것입니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="effect-관점으로-생각하기">Effect 관점으로 생각하기<a class="hash-link" href="#effect-관점으로-생각하기" title="제목으로 바로 가기">​</a></h3><p><code>ChatRoom</code> 컴포넌트 관점에서 일어나는 모든 것을 요약해봅시다.</p><ol><li><code>ChatRoom</code>은 <code>&quot;general&quot;</code>로 설정된 <code>roomId</code>로 마운트합니다.</li><li><code>ChatRoom</code>은 <code>&quot;travel&quot;</code>로 설정된 <code>roomId</code>로 업데이트합니다.</li><li><code>ChatRoom</code>은 <code>&quot;music&quot;</code>로 설정된 <code>roomId</code>로 업데이트합니다.</li><li><code>ChatRoom</code>은 언마운트합니다.</li></ol><p>컴포넌트의 생명주기에서 각 지점마다 Effect는 다른 일들을 했습니다.</p><ol><li>Effect는 <code>&quot;general&quot;</code> 방에 연결합니다.</li><li>Effect는 <code>&quot;general&quot;</code> 방과의 연결을 끊고 <code>&quot;travel&quot;</code> 방과 연결합니다.</li><li>Effect는 <code>&quot;travel&quot;</code> 방과의 연결을 끊고 <code>&quot;music&quot;</code> 방과 연결합니다.</li><li>Effect는 <code>&quot;music&quot;</code> 방과의 연결을 끊습니다.</li></ol><p>이제 Effect의 관점으로 무슨 일이 일어났는지 생각해 봅시다.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Effect는 roomId가 특정된 방과 연결을 합니다...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// ...연결이 끊길 때까지</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">disconnect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">roomId</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>이 코드구조는 일련의 중복되지 않게 일어난 사건들을 보여주면서 여러분이 무슨 일이 일어났는지 알게 해줍니다.</p><ol><li>Effect는 <code>&quot;general&quot;</code> 방에 연결합니다.(연결이 끊길 때까지)</li><li>Effect는 <code>&quot;travel&quot;</code> 방에 연결합니다.(연결이 끊길 때까지)</li><li>Effect는 <code>&quot;music&quot;</code> 방에 연결합니다.(연결이 끊길 때까지)</li></ol><p>이전에 여러분은 컴포넌트 관점으로 생각했습니다.
컴포넌트 관점으로 바라봤을 때, &quot;렌더링 후&quot; 또는 &quot;언마운트 전&quot;과 같은 특정 때에 일어나는 &quot;callback&quot; 또는 &quot;생명주기 이벤트&quot;로 Effect를 생각하는 경향이 있었을 것입니다.
이러한 방식의 사고는 빠르게 복잡해 질 수 있으므로 가능한 피하는 것이 좋습니다.</p><p><strong>대신에 한 번에 하나의 시작/멈춤 주기에 집중하세요. 컴포넌트가 마운트하거나 업데이트하거나 언마운트하는 것과는 전혀 상관이 없습니다.</strong>
<strong>여러분이 해야 할 일은 어떻게 동기화를 시작하고 동기화를 멈출 수 있는지 설명하는 것입니다.</strong>
<strong>만약 여러분이 이 설명을 잘해낸다면, Effect는 필요한 만큼 많이 시작과 멈춤을 반복할 것입니다.</strong></p><p>JSX를 생성하는 렌더링 로직을 작성할 때 컴포넌트가 마운트 또는 업데이트를 할지 안할지 여러분이 생각하지 방식과 비슷합니다.
여러분은 화면에 무엇이 있어야 할지 설명하고 React가 <a href="https://beta.reactjs.org/learn/reacting-to-input-with-state" target="_blank" rel="noopener noreferrer">나머지를 알아서 처리</a>합니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="effect의-재동기화-여부를-react가-알아내는-방법">Effect의 재동기화 여부를 React가 알아내는 방법<a class="hash-link" href="#effect의-재동기화-여부를-react가-알아내는-방법" title="제목으로 바로 가기">​</a></h3><p>아래 여러분이 실습할 수 있는 예시가 있습니다. <code>ChatRoom</code> 컴포넌트를 마운트하기 위해 &quot;Open chat&quot; 버튼을 누릅니다.</p><iframe src="https://codesandbox.io/s/oyyqps?file=%2FApp.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>컴포넌트가 처음으로 마운트할 때, 여러분은 다음 세가지 로그에 주목하세요.</p><ol><li><code>✅ https://localhost:1234... 에서 &quot;general&quot; 방에 연결</code> (오직 개발환경에서만)</li><li><code>❌ https://localhost:1234... 에서 &quot;general&quot; 방 연결 끊기</code>(오직 개발환경에서만)</li><li><code>✅ https://localhost:1234... 에서 &quot;general&quot; 방에 연결</code></li></ol><p>처음 두 로그는 오직 개발환경에서만 보입니다.
개발환경에서 React는 항상 각 컴포넌트를 한 번 재마운트합니다.
즉, <strong>React는 개발환경에서 재마운트함으로서 Effect가 재동기화되는지 확인합니다.</strong>
문 자물쇠가 잘 작동하는지 검사하기 위해 한 번 문을 열고 닫는 것과 비슷합니다.
React는 여러분이 Effect 제거를 잘 실행했는지 검사하기 위해 개발환경에서 Effect를 한 번 시작하고 멈춥니다.</p><p>실전에서 Effect가 재동기화되는 주요 이유는 Effect가 사용하는 데이터가 변해서입니다.
위의 Sandbox에서 선택된 챗 방을 변경해 보세요.
어떻게, 언제 <code>roomId</code>가 변경이 되고 Effect가 재동기화되는지 주목하세요.</p><p>하지만, 재동기화 필요한 흔하지 않은 경우들이 더 있습니다.
예를 들어, 챗이 열려있는 동안 위의 Sandbox의 <code>serverUrl</code>을 편집을 시도합니다.
코드 편집에 따라서 Effect가 어떻게 재동기화하는지 보세요.
앞으로 React는 재동기화의 이점을 활용하는 더 많은 기능들을 추가할 것입니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="effect를-재동기화할-필요가-있다는-것을-react가-알아내는-법">Effect를 재동기화할 필요가 있다는 것을 React가 알아내는 법<a class="hash-link" href="#effect를-재동기화할-필요가-있다는-것을-react가-알아내는-법" title="제목으로 바로 가기">​</a></h3><p><code>roomId</code>가 변경된 후 Effect가 재동기화가 필요하다는 것을 React가 어떻게 아는지 궁금할 것입니다.
그 이유는 바로 여러분이 <a href="https://beta.reactjs.org/learn/synchronizing-with-effects#step-2-specify-the-effect-dependencies" target="_blank" rel="noopener noreferrer">의존성 배열</a>에 <code>roomId</code>를 넣음으로서 이 Effect 코드가 <code>roomId</code>에 의존적이라고 <em>React에게 말했기</em> 때문입니다.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> roomId </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// roomId prop은 시간이 지나서 변할 수 있습니다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 이 Effect는 roomId를 읽습니다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">disconnect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">roomId</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 이 Effect가 roomId에 &quot;의존적&quot;이라고 React에 알리고 있습니다 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>아래 동작하는 방식입니다.</p><ol><li><code>roomId</code>가 prop이므로 <code>roomId</code>가 시간이 지나 변할 수 있습니다.</li><li>Effect는 <code>roomId</code>를 읽고 있습니다 (따라서 Effect 로직은 나중에 변할지도 모르는 값에 의존하고 있습니다).</li><li>Effect의 의존성에 <code>roomId</code>를 추가한 이유입니다 (<code>roomId</code>가 변할 때 Effect를 재동기화하기 위해서).</li></ol><p>컴포넌트가 리렌더링될 때마다, React는 여러분이 넘긴 Effect의 의존성 배열을 바라볼 것입니다.
배열의 어떠한 값이라도 이전 렌더링에서 여러분이 넘긴 값과 달라진다면 React는 Effect를 재동기화할 것입니다.
예를 들어, 초기 렌더링에서 <code>[&quot;general&quot;]</code>을 넘겼고 다음 렌더링에서 <code>[&quot;travel&quot;]</code>을 넘겼다면, React는 <code>[&quot;general&quot;]</code>과 <code>[&quot;travel&quot;]</code>을 비교할 것입니다.
이 두 값은 (<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is" target="_blank" rel="noopener noreferrer"><code>Object.is</code></a>로 비교했을 때) 서로 다르기 때문에 React는 Effect를 재동기화할 것입니다.
다른 한편으로 <code>roomId</code>가 변경되지 않은 채로 컴포넌트가 재렌더링되었다면, Effect는 같은 방에 연결된 채 남아있을 것입니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="각각의-effect는-분리된-동기화-과정을-가집니다">각각의 Effect는 분리된 동기화 과정을 가집니다<a class="hash-link" href="#각각의-effect는-분리된-동기화-과정을-가집니다" title="제목으로 바로 가기">​</a></h3><p>Effect에 관련없는 로직을 추가하는 것을 지양해야 합니다. 왜냐하면 이 로직은 여러분이 이미 작성한 Effect와 동시에 실행될 필요가 있기 때문입니다.
예를 들어, 사용자가 방을 방문할 때 분석 이벤트를 보내기를 원한다고 가정해 봅시다.
<code>roomId</code>에 의존적인 Effect가 이미 있으므로 이곳에 분석 함수를 넣으면 될 거라 여길수도 있습니다.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> roomId </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">logVisit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">disconnect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">roomId</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>하지만 나중에 이 Effect에 연결을 다시 만드는데 필요한 또다른 의존성을 추가한다고 생각해 봅시다.
이 Effect가 재동기화한다면, Effect는 같은 방에서 <code>logVisit(roomId)</code>를 또 호출할 것입니다. 그리고 이는 여러분이 의도하지 않은 것입니다.
방문을 로그화하는 것은 연결과는 <strong>독립적인 과정</strong>입니다.
<code>logVisit(roomId)</code>와 이미 작성된 Effect가 두개의 독립적인 Effect로 쓰여져야 하는 이유입니다.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> roomId </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">logVisit</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">roomId</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">roomId</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>여러분의 코드에서 각각의 Effect는 분리되고 독립적인 동기화 과정을 나타내야만 합니다.</strong></p><p>위의 예시에서, 하나의 Effect를 제거하는 것은 다른 Effect 로직에 영향을 주지 않습니다.
두 Effect가 각자 다른 것들을 동기화한다는 좋은 지표이며 그들을 분리하는 게 맞다는 것을 알 수 있습니다.
다른 한편으로, 분리된 Effect에서 공통적인 로직 조각을 분리한다면, 코드는 &quot;더 깔끔하게&quot; 보일 수 있지만 <a href="https://beta.reactjs.org/learn/you-might-not-need-an-effect#chains-of-computations" target="_blank" rel="noopener noreferrer">유지하기 더 어려워질</a> 수 있습니다.
코드가 깨끗한지와는 상관없이 과정이 같은지 분리되어 있는지 여러분이 고민해야 하는 이유입니다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="effect는-reactive-값에-반응한다">Effect는 reactive 값에 &#x27;반응&#x27;한다<a class="hash-link" href="#effect는-reactive-값에-반응한다" title="제목으로 바로 가기">​</a></h2><p>Effect는 두 변수(<code>serverUrl</code>과<code>roomId</code>),를 읽지만 여러분은 <code>roomId</code>만 의존성으로 작성했습니다.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> serverUrl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;https://localhost:1234&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> roomId </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">disconnect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">roomId</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>왜 <code>serverUrl</code>은 의존성이 필요하지 않을까요?</p><p>그 이유는 <code>serverUrl</code>은 재렌더링으로 인해 절대 변하지 않기 때문입니다.
<code>serverUrl</code>은 컴포넌트가 얼마나 많이 어떠한 prop과 상태를 가지고 재렌더링하는지에 상관없이 항상 같습니다.
<code>serverUrl</code>은 절대 변하지 않기 때문에, Effect의 의존성에 넣을 필요가 없습니다.
결국 의존성은 의존성 내 값들이 시간이 지나 변할 때만 무언가 일으킵니다.</p><p>다른 한편으로, <code>roomId</code>는 재렌더링 시 변할 수 있습니다.
<strong>컴포넌트 내에 선언된 prop, 상태, 그리고 다른 값들은 React 데이터 흐름에 참여하고 렌더링동안 계산되기 때문에 reactive합니다.</strong></p><p>만약 <code>serverUrl</code>이 상태변수라면, 이 변수는 reactive 였을 것입니다.
Reactive 값은 의존성에 반드시 포함되어야 합니다.</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> roomId </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// prop은 시간이 지나 변합니다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> setServerUrl</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;https://localhost:1234&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 상태는 시간이 지나 변합니다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Effect는 prop와 상태를 읽습니다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">disconnect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">roomId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> serverUrl</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 이 Effect는 prop과 상태에 &quot;의존적&quot;이라고 React에 알리고 있습니다 </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>serverUrl</code>을 의존성에 포함함으로서 <code>serverUrl</code>이 변경되면 Effect가 재동기화 할 것이라는 것을 확신할 것입니다.</p><p>아래 Sandbox에서 선택된 챗 방을 변경하거나 서버 url을 편집해 보세요.</p><iframe src="https://codesandbox.io/s/hov07i?file=%2FApp.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>여러분이 <code>roomId</code> 또는 <code>serverUrl</code>와 같은 reactive 값을 변경할 때마다 Effect는 챗 서버에 재연결합니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="빈-배열을-가진-effect가-의미하는-것">빈 배열을 가진 Effect가 의미하는 것<a class="hash-link" href="#빈-배열을-가진-effect가-의미하는-것" title="제목으로 바로 가기">​</a></h3><p><code>roomId</code>과 <code>serverUrl</code> 둘 다 컴포넌트 밖으로 이동시키면 무슨 일이 일어날까요?</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> serverUrl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;https://localhost:1234&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> roomId </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;general&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">disconnect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// ✅ 의존성이 모두 선언되었습니다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>이제 여러분의 Effect 코드는 어떠한 reactive 값도 사용하고 있지 않으므로 Effect의 의존성은 비어있습니다(<code>[]</code>).</p><p>컴포넌트 관점에서 생각한다면, 빈 <code>[]</code> 의존성 배열은 이 Effect가 컴포넌트 마운트할 때만 챗 방에 연결하고 컴포넌트 언마운트할 때만 연결을 끊는다는 것을 의미합니다.
(Effect 로직 부하테스트를 위해 React는 여전히 개발환경에서 <a href="https://react.dev/learn/lifecycle-of-reactive-effects#how-react-verifies-that-your-effect-can-re-synchronize" target="_blank" rel="noopener noreferrer">추가로 Effect를 재동기화한다는 것</a>을 명심하세요.)</p><iframe src="https://codesandbox.io/s/9bpb0q?file=%2FApp.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>하지만, <a href="https://beta.reactjs.org/learn/lifecycle-of-reactive-effects#thinking-from-the-effects-perspective" target="_blank" rel="noopener noreferrer">Effect 관점에서 생각</a>한다면, 마운팅과 언마운팅에 대해 전혀 고민할 필요가 없습니다.
중요한 점은 Effect가 동기화를 시작하고 멈출 때 Effect가 할 일을 여러분이 정해놓았다는 것입니다.
현재, Effect는 어떠한 reactive 의존성을 가지고 있지 않습니다.
하지만 <code>roomId</code> 또는 <code>serverUrl</code>을 시간이 지나 사용자가 변경하는 것(따라서 두 값이 reactive가 되는 것)을 여러분이 원한다고 할 때, Effect 내부 코드는 변경하지 않아도 됩니다.
여러분은 의존성에 <code>roomId</code> 또는 <code>serverUrl</code>을 추가하면 됩니다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="컴포넌트의-body-영역에-선언되어있는-모든-변수들은-reactive-합니다">컴포넌트의 body 영역에 선언되어있는 모든 변수들은 reactive 합니다.<a class="hash-link" href="#컴포넌트의-body-영역에-선언되어있는-모든-변수들은-reactive-합니다" title="제목으로 바로 가기">​</a></h2><p>prop과 상태만이 reactive한 값이 아닙니다. 그것을 가지고 계산한 값들 또한 reactive합니다.
만약 prop 또는 상태가 변한다면, 컴포넌트는 리랜더링 될 것이고 prop과 상태에서 계산된 값도 변할 것입니다. Effect에 사용되는 컴포넌트 body 내부의 모든 변수들이 Effect 의존성 리스트에 있어야 하는 이유입니다.</p><p>사용자가 채팅 서버를 선택할 수 있다고 말해봅시다. 하지만 환경설정에서 기본 서버를 설정할수도 있습니다.
이미 <a href="https://react.dev/learn/scaling-up-with-reducer-and-context" target="_blank" rel="noopener noreferrer">context</a>에 설정 상태를 넣어서 context에서 <code>settings</code>를 읽을 수 있다고 가정해봅시다. 이제 props에서 가져온 선택된 서버와 기본 서버에 기반해 <code>serverUrl</code>을 계산합니다.</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> roomId</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> selectedServerUrl </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// roomId 는 reactive 힙니다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> settings </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useContext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">SettingsContext</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// settings 는 reactive 힙니다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> serverUrl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> selectedServerUrl </span><span class="token operator" style="color:#393A34">??</span><span class="token plain"> settings</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">defaultServerUrl</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// serverUrl 는 reactive 합니다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Effect 에서 roomId 와 serverUrl 을 읽습니다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">disconnect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">roomId</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> serverUrl</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// 둘 중 하나가 변할때마다 다시 동기화할 필요가 있습니다!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>이 예시에서, <code>serverUrl</code>은 prop이나 상태 변수가 아닙니다. 그것은 렌더링 동안에 계산하는 일반 변수입니다. 따라서 렌더링 동안에 계산되기 때문에, 리랜더링 때문에 변경될 수 있습니다. serverUrl이 reactive한 이유입니다.</p><p><strong>컴포넌트 안의 모든 값들(props, 상태, 그리고 body 안에 있는 변수들을 포함해서)은 reactive합니다. 어떤 reactive한 값도 리렌더링에 변화할 수 있기 때문에 Effect의 의존성으로 reactive한 값들을 포함시킬 필요가 있습니다.</strong></p><p>다른 말로, Eeffect는 컴포넌트의 body에 있는 모든 값들에 &quot;반응&quot;합니다.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>DEEP DIVE</div><div class="admonitionContent_S0QG"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="전역-값-또는-가변-값이-종속성이-될-수-있나요">전역 값 또는 가변 값이 종속성이 될 수 있나요?<a class="hash-link" href="#전역-값-또는-가변-값이-종속성이-될-수-있나요" title="제목으로 바로 가기">​</a></h3><p>가변적인 변수 값(글로벌 변수 포함)은 reactive 하지 않습니다.</p><p><strong><a href="https://developer.mozilla.org/en-US/docs/Web/API/Location/pathname" target="_blank" rel="noopener noreferrer"><code>location.pathname</code></a>과 같은 가변적인 변수 값은 종속성일 수 없습니다.</strong> 이것은 가변적이기 때문에 React 렌더링 데이터 흐름 밖에서 언제든지 변경될 수 있습니다. 변경해도 컴포넌트가 다시 렌더링되지 않습니다. 따라서 종속성에 지정한 경우에도 그 값이 변경될 때 Effect를 다시 동기화할 수 없습니다. 렌더링 중(의존성을 계산할 때) 가변 데이터를 읽으면 <a href="https://react.dev/learn/keeping-components-pure" target="_blank" rel="noopener noreferrer">렌더링의 순수성</a>이 깨지기 때문에 이는 React의 규칙도 위반합니다. 대신, <a href="https://react.dev/learn/you-might-not-need-an-effect#subscribing-to-an-external-store" target="_blank" rel="noopener noreferrer">useSyncExternalStore</a>를 사용하여 외부의 가변적인 변수 값을 읽고 구독해야 합니다.</p><p><strong><a href="https://react.dev/reference/react/useRef#reference" target="_blank" rel="noopener noreferrer">ref.current</a>와 같은 가변적인 변수 또는 ref.current에서 읽은 값도 종속성이 될 수 없습니다.</strong> <code>useRef</code>에서 반환된 ref 객체 자체는 종속성일 수 있지만 <code>현재</code> 속성은 의도적으로 변경할 수 있습니다. 이 기능을 사용하면 <a href="https://react.dev/learn/referencing-values-with-refs" target="_blank" rel="noopener noreferrer">리랜더링을 유발하지 않고 무언가를 추적할 수 있습니다</a>. 그러나 변경해도 리랜더링을 일으키지 않으므로 reactive한 값이 아니며, 변경될 때 React는 Effect를 다시 실행해야하는지 알 수 없습니다.</p><p>이 페이지에서 아래에서 알게 될 것처럼, linter는 이러한 문제를 자동으로 확인합니다.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="react는-모든-reactive한-값을-종속성으로-지정했는-지-확인합니다">React는 모든 reactive한 값을 종속성으로 지정했는 지 확인합니다.<a class="hash-link" href="#react는-모든-reactive한-값을-종속성으로-지정했는-지-확인합니다" title="제목으로 바로 가기">​</a></h2><p>linter가 <a href="https://react.dev/learn/editor-setup#linting" target="_blank" rel="noopener noreferrer">React용으로 설정된</a> 경우 Effect 코드에서 사용되는 모든 reactive한 값이 종속성으로 선언되는지 확인합니다. 예를 들어 <code>roomId</code>와 <code>serverUrl</code>이 모두 reactive 때문에 이 코드는 lint 오류입니다:</p><iframe src="https://codesandbox.io/s/u2grt7?file=%2FApp.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>이것은 React 오류처럼 보일 수 있지만 React는 코드의 버그를 지적하고 있습니다. <code>roomId</code>와 <code>serverUrl</code> 모두 시간이 지남에 따라 변경될 수 있지만, 변경될 때 Effect를 다시 동기화하는 것을 잊을 것입니다. 사용자가 UI에서 다른 값을 선택한 후에도 초기 <code>roomId</code> 및 <code>serverUrl</code>에 계속 연결되도록 남아있어야 합니다.</p><p>버그를 수정하려면 linter의 제안에 따라 <code>roomId</code> 및 <code>serverUrl</code>을 Effect의 종속성으로 지정합니다:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter"> roomId </span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// roomId is reactive</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> setServerUrl</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;https://localhost:1234&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// serverUrl 은 reactive 힙니다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">disconnect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// ✅ 모든 의존성이 선언되었습니다.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>위의 샌드박스에서 수정해보세요. linter 오류가 사라지고 필요할 때 채팅을 다시 연결하는지 확인해보세요.</p><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Note</div><div class="admonitionContent_S0QG"><p>경우에 따라 React는 값이 컴포넌트 내부에서 선언되더라도 값이 변경되지 않는다는 것을 <em>알고 있습니다</em>. 예를 들어, <code>useState</code>에서 반환된 <a href="https://react.dev/reference/react/useState#setstate" target="_blank" rel="noopener noreferrer"><code>set</code> 함수</a>와 <code>[useRef](https://react.dev/reference/react/useRef)</code>에서 반환된 ref 개체는 안정적이며, 리랜더링할 때 변경되지 않습니다. 안정된 값은 reactive하지 않으므로 배열에서 제외할 수 있습니다. 그들을 포함하는 것은 허용됩니다. 변하지 않기 때문에, 중요하지 않습니다.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="재동기화를-원하지-않을-때-해야-할-것">재동기화를 원하지 않을 때 해야 할 것<a class="hash-link" href="#재동기화를-원하지-않을-때-해야-할-것" title="제목으로 바로 가기">​</a></h2><p>이전 예제에서는 <code>roomId</code>와 <code>serverUrl</code>을 종속성으로 배열하여 lint 오류를 해결했습니다.</p><p><strong>그러나 이러한 값이 reactive한 값이 아니라는 것을 linter에 &quot;증명&quot;할 수 있습니다.</strong> 즉, 리랜더링의 결과로 변경될 수 없다는 것을요. 예를 들어, <code>serverUrl</code>과 <code>roomId</code>가 렌더링에 의존하지 않고 항상 동일한 값을 가지는 경우 컴포넌트 외부로 이동할 수 있습니다. 이제 종속성일 필요가 없습니다:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> serverUrl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;https://localhost:1234&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// serverUrl 는 reactive 하지 않습니다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> roomId </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;general&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// roomId 는 reactive 하지 않습니다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">disconnect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// ✅ 모든 의존성이 선언되었습니다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><em>Effect 내부로</em> 이동할 수도 있습니다. 렌더링 시 계산되지 않으므로 reactive하지 않습니다:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">ChatRoom</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> serverUrl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;https://localhost:1234&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// serverUrl 는 reactive 하지 않습니다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> roomId </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;general&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// roomId 는 reactive 하지 않습니다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> connection </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createConnection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> roomId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        connection</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">disconnect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// ✅ 모든 의존성이 선언되었습니다</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Effect는 reactive한 코드 블록입니다.</strong> Effect 내부에 여러분이 읽은 값들이 변경되면 Effect는 다시 동기화됩니다. 상호 작용당 한 번만 실행되는 이벤트 핸들러와 달리 효과는 동기화가 필요할 때마다 실행됩니다.</p><p><strong>종속성을 &quot;선택&quot;할 수 없습니다.</strong> 종속성은 효과에서 읽은 모든 <a href="https://react.dev/learn/lifecycle-of-reactive-effects#all-variables-declared-in-the-component-body-are-reactive" target="_blank" rel="noopener noreferrer">reactive한 값</a>을 포함해야 합니다. linter가 이를 적용합니다. 이로 인해 무한 루프와 같은 문제가 발생하고 효과가 너무 자주 다시 동기화될 수 있습니다. linter를 억제해서 이 문제를 해결해서는 안됩니다! 대신 시도해 볼 내용은 다음과 같습니다:</p><ul><li><p><strong>Effect가 독립적인 동기화 프로세스를 나타내는지 확인합니다.</strong> Effect가 아무것도 동기화하지 않으면 <a href="https://react.dev/learn/you-might-not-need-an-effect" target="_blank" rel="noopener noreferrer">불필요한 렌더링일 수 있습니다.</a>. 여러 개의 독립적인 것을 동기화하는 경우 <a href="https://react.dev/learn/lifecycle-of-reactive-effects#each-effect-represents-a-separate-synchronization-process" target="_blank" rel="noopener noreferrer">코드를 나누세요.</a>.</p></li><li><p><strong>prop이나 상태의 최신 값을 &quot;반응&quot;하지 않은 채 읽고 효과를 다시 동기화하려면 Effect를 reactive한 부분(Effect에서 유지)과 reactove하지 않는 부분(Effect 이벤트라고 하는 부분으로 추출)으로 나눌 수 있습니다.</strong> <a href="https://react.dev/learn/separating-events-from-effects" target="_blank" rel="noopener noreferrer">이벤트와 Effect를 구분하는 방법에 대해 읽어보십시오.</a></p></li><li><p><strong>객체 및 함수을 종속성으로 사용하는 것을 피하세요.</strong> 렌더링하는 동안 객체와 함수를 만든 다음 Effect에서 읽으면 렌더링마다 객체와 함수가 달라집니다. 이렇게 하면 Effect가 매번 다시 동기화됩니다. <a href="https://react.dev/learn/removing-effect-dependencies" target="_blank" rel="noopener noreferrer">Effects에서 불필요한 종속성을 제거하는 방법에 대해 자세히 알아보십시오.</a></p></li></ul><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>주의할 점</div><div class="admonitionContent_S0QG"><p>linter는 당신의 친구이지만, 그 힘은 제한되어 있습니다. linter는 의존성이 잘못된 경우에만 알 수 있습니다. linter는 각각의 사건을 해결하는 최선의 방법을 알지 못합니다. linter가 종속성을 제안하지만 이를 추가하면 루프가 발생하는 경우 linter를 무시해야 하는 것은 아닙니다. 이 값이 reactive하지 않고 종속적일 필요가 없도록 Effect 내부(또는 외부)의 코드를 변경해야 합니다.</p><p>기존 코드베이스가 있는 경우 다음과 같이 linter를 억제하는 효과가 있을 수 있습니다:</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 🔴 linter를 이렇게 억누르는 것을 피하세요:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// eslint-ignore-next-line react-hooks/exhaustive-deps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="클립보드에 코드 복사" title="복사" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a href="https://react.dev/learn/removing-effect-dependencies" target="_blank" rel="noopener noreferrer">다음 페이지</a>에서는 규칙을 위반하지 않고 이 코드를 수정하는 방법에 대해 배울 것입니다. 항상 고칠만한 가치가 있습니다!</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="되짚어보기">되짚어보기<a class="hash-link" href="#되짚어보기" title="제목으로 바로 가기">​</a></h2><ul><li>컴포넌트는 마운트, 업데이트 및 마운트 해제할 수 있습니다.</li><li>각 Effect에는 주변 컴포넌트와 별도의 수명 주기가 있습니다.</li><li>각 Effect는 시작 및 중지할 수 있는 별도의 동기화 프로세스를 설명합니다.</li><li>Effect를 쓰고 읽을 때 컴포넌트의 관점(마운트, 업데이트 또는 마운트 해제 방법)보다는 각 개별 Effect의 관점(동기화를 <em>시작</em> 및 <em>중지</em>하는 방법)에서 생각합니다.
컴포넌트 본문 내부에 선언된 값은 &quot;reactive&quot;합니다.</li><li>reactive한 값은 시간이 지남에 따라 변경될 수 있으므로 Effect를 다시 동기화해야 합니다.</li><li>linter는 Effect 내에서 사용되는 모든 reactive한 값이 종속성으로 지정되었는지 확인합니다.</li><li>linter에 의해 빨간줄이 그어진 모든 오류는 정당한 이유가 있습니다. 규칙을 어기지 않도록 코드를 수정하는 방법은 항상 있습니다.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="도전해보기">도전해보기<a class="hash-link" href="#도전해보기" title="제목으로 바로 가기">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-모든-키-입력마다-다시-연결되는-것을-수정하기">1. 모든 키 입력마다 다시 연결되는 것을 수정하기<a class="hash-link" href="#1-모든-키-입력마다-다시-연결되는-것을-수정하기" title="제목으로 바로 가기">​</a></h3><p>이 예시에서 <code>ChatRoom</code> 컴포넌트는 컴포넌트가 마운트될 때 채팅 룸에 연결하고, 마운트 해제될 때 연결을 끊고, 다른 채팅 룸을 선택할 때 다시 연결합니다. 이 동작은 올바르므로 계속 작동해야 합니다.</p><p>하지만, 한 가지 문제가 있습니다. 하단의 메시지 상자 입력에 입력할 때마다 ChatRoom은 채팅에 다시 연결됩니다. (콘솔을 지우고 입력해보면 이를 알 수 있습니다.) 이 문제가 발생하지 않도록 문제를 해결해보세요.</p><iframe src="https://codesandbox.io/s/8p4qro?file=%2FApp.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><h3 class="anchor anchorWithStickyNavbar_LWe7" id="힌트">힌트<a class="hash-link" href="#힌트" title="제목으로 바로 가기">​</a></h3><p>이 Effect를 위해 종속성 배열을 추가해야 할 수 있습니다. 어떤 종속성이 있어야 될까요?</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="해답">해답<a class="hash-link" href="#해답" title="제목으로 바로 가기">​</a></h3><p>이 Effect에는 종속성 배열이 전혀 없으므로 다시 렌더링할 때마다 다시 동기화됩니다. 먼저 종속성 배열을 추가합니다. 그런 다음 Effect에서 사용되는 모든 reactive한 값이 배열에 지정되어 있는지 확인합니다. 예를 들어 <code>roomId</code>는 (prop이기 때문에) reactove히므로 배열에 포함되어야 합니다. 이렇게 하면 사용자가 다른 채팅방을 선택할 때 대화가 다시 연결됩니다. 반면에 <code>serverUrl</code>은 컴포넌트 외부에서 정의됩니다. 이것이 배열에 포함될 필요가 없는 이유입니다.</p><iframe src="https://codesandbox.io/s/rp5m1k?file=%2FApp.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-스위치를-켜고-끄는-것을-동기화하기">2. 스위치를 켜고 끄는 것을 동기화하기<a class="hash-link" href="#2-스위치를-켜고-끄는-것을-동기화하기" title="제목으로 바로 가기">​</a></h3><p>이 예시에서 Effect는 윈도우 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/pointermove_event" target="_blank" rel="noopener noreferrer"><code>pointermove</code></a> 이벤트를 구독하여 화면의 분홍색 점을 이동합니다. 미리 보기 영역 위를 맴돌거나 (모바일 장치에 있는 경우 화면을 터치하여) 분홍색 점이 어떻게 이동하는지 확인합니다.</p><p>체크박스도 있습니다. 체크박스을 선택하면 <code>canMove</code> 상태 변수가 전환되지만 이 상태 변수는 코드 어디에서도 사용되지 않습니다. <code>canMove</code>가 false일 때(체크박스가 선택 취소됨) 점이 이동을 중지하도록 코드를 변경해야합니다. 체크박스를 다시 켠 후에 (<code>canMove</code>를 true로 설정하면) 확인란이 다시 이동해야합니다. 즉, 점이 이동할 수 있는지 여부는 체크박스가 선택되어 있는지 여부와 동기화된 상태로 유지되어야 합니다.</p><iframe src="https://codesandbox.io/s/s9xp8g?file=%2FApp.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><h3 class="anchor anchorWithStickyNavbar_LWe7" id="힌트-1">힌트<a class="hash-link" href="#힌트-1" title="제목으로 바로 가기">​</a></h3><p>조건부로 Effect를 선언할 수 없습니다. 그러나 Effect 내부의 코드는 조건을 사용할 수 있습니다!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="해답-1">해답<a class="hash-link" href="#해답-1" title="제목으로 바로 가기">​</a></h3><p>한 가지 답은 <code>setPosition</code> 호출을 <code>if(canMove) {... }</code> 조건안에서 부르는 것입니다:</p><iframe src="https://codesandbox.io/s/18j4mw?file=%2FApp.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>대안으로는 <code>if(canMove) {... }</code> 조건을 <em>이벤트 구독</em> 로직으로 감쌀 수 있습니다:</p><iframe src="https://codesandbox.io/s/4bevbk?file=%2FApp.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>이 두 경우 모두 <code>canMove</code>는 Effect 내부에서 읽은 reactive한 변수입니다. 따라서 Effect 종속성 목록에 이 값을 지정해야 합니다. 이렇게 하면 값이 변경될 때마다 Effect가 다시 동기화됩니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-오래된-값-오류를-조사하기">3. 오래된 값 오류를 조사하기<a class="hash-link" href="#3-오래된-값-오류를-조사하기" title="제목으로 바로 가기">​</a></h3><p>이 예에서 분홍색 점은 체크박스가 켜져 있을 때 이동해야 하며 체크박스가 꺼져 있을 때 이동을 중지해야 합니다. 이에 대한 논리는 이미 구현되었습니다. <code>handleMove</code> 이벤트 핸들러는 <code>canMove</code> 상태 변수를 확인합니다.</p><p>그러나 어떤 이유로 <code>handleMove</code> 내부의 <code>canMove</code> 상태 변수는 &quot;오래된 값&quot;으로 표시됩니다. 체크박스를 선택 취소한 후에도 항상 true입니다. 이것이 어떻게 가능한 걸까요? 코드의 오류를 찾아 수정해보세요.</p><iframe src="https://codesandbox.io/s/rbklij?file=%2FApp.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><h3 class="anchor anchorWithStickyNavbar_LWe7" id="힌트-2">힌트<a class="hash-link" href="#힌트-2" title="제목으로 바로 가기">​</a></h3><p>linter 규칙이 억제되는 것이 보이면 억제를 없애세요! 거기가 보통 실수하는 곳입니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="해답-2">해답<a class="hash-link" href="#해답-2" title="제목으로 바로 가기">​</a></h3><p>원래 코드의 문제는 종속성 linter를 억제하는 것이었습니다. 억제를 제거하면 이 Effect가 <code>handleMove</code> 기능에 따라 달라진다는 것을 알 수 있습니다. 이는 의미가 있습니다. <code>handleMove</code>는 컴포넌트 본체 내부에서 선언되므로 reactive한 값이 됩니다. 모든 reactive한 값을 종속성으로 지정해야 합니다. 그렇지 않으면 시간이 지남에 따라 낡은 값이 될 수 있습니다!</p><p>원래 코드의 작성자는 Effect가 reactive힌 값에 의존하지 않는다고 말하며 반응에 &quot;거짓말&quot;을 했습니다(<code>[]</code>). 이것은 React가   <code>canMove</code> 변경 후 Effect를 다시 동기화하지 않은 이유입니다(<code>handleMove</code>도 같이). React가 Effect를 다시 동기화하지 않았기 때문에 리스너로 첨부된 <code>handleMove</code>는 초기 렌더 중에 생성된 <code>handleMove</code> 함수입니다. 초기 렌더 동안 <code>canMove</code>는 true였으며, 이 때문에 초기 렌더링에서 생긴 <code>handleMove</code>는 해당 값을 영원히 볼 수 있습니다.</p><p><strong>linter를 억제하지 않으면 오래된 값에 문제가 발생하지 않습니다.</strong> 이 버그를 해결하는 몇 가지 다른 방법이 있지만 항상 linter 억제를 제거하는 것부터 시작해야 합니다. 그런 다음 코드를 변경하여 lint 오류를 해결합니다.</p><p>Effect 종속성을 <!-- -->[<code>handleMove</code>]<!-- -->로 변경할 수 있지만 모든 렌더에 대해 새로 정의된 함수가 되므로 종속성 배열에서 제거하는 것이 좋습니다. 그러면 <em>다시 렌더링할 때마다 Effect가 다시 동기화됩니다.</em></p><iframe src="https://codesandbox.io/s/w134i4?file=%2FApp.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>이 해답은 이상적이지는 않습니다. Effect 안에 <code>console.log(&#x27;Resubscribing&#x27;)</code>를 넣으면 리렌더할 때마다 다시 구독하는 것을 알 수 있습니다. 재구독은 빠르지만, 그렇게 자주 하는 것은 피하는 것이 좋을 것입니다.</p><p><code>handleMove</code> 기능을 Effect 내부로 이동하는 것이 더 좋습니다. 그러면 <code>handleMove</code>는 reactive한 값이 아니므로 Effect가 함수에 의존하지 않습니다. 대신 이펙트 내부에서 코드가 읽히는 <code>canMove</code>에 의존해야 합니다. 이제 Effect가 <code>canMove</code> 값과 동기화된 상태로 유지되므로 원하는 동작과 일치합니다:</p><iframe src="https://codesandbox.io/s/kw7vqn?file=%2FApp.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>Effect 본문 안에 console.log(&#x27;Resubscribing&#x27;)를 추가하면 체크박스를 변경하거나(<code>canMode</code>가 변경됩니다) 코드를 편집할 때만 다시 구독합니다.
이를 통해 항상 다시 구독하는 이전 접근 방식보다 효율적이게 되었습니다.</p><p>이러한 유형의 문제에 대한 보다 일반적인 접근 방식은 <a href="https://react.dev/learn/separating-events-from-effects" target="_blank" rel="noopener noreferrer">Effect에서 이벤트 분리하기</a>에서 배우게 됩니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4-스위치-연결-고치기">4. 스위치 연결 고치기<a class="hash-link" href="#4-스위치-연결-고치기" title="제목으로 바로 가기">​</a></h3><p>이 예에서 <code>chat.js</code>의 채팅 서비스는 두 가지 다른 API를 제공합니다:<code>createEncryptedConnection</code> 와 <code>createUnencryptedConnection</code>입니다. 루트 <code>App</code> 컴포넌트는 사용자가 암호화 사용 여부를 선택할 수 있도록 한 다음 해당 API 메서드를 하위 <code>ChatRoom</code> 컴포넌트에 <code>createConnection</code> prop으로 전달합니다.</p><p>처음에는 콘솔 로그에 연결이 암호화되지 않았다고 표시됩니다. 체크박스를 켜 보십시오: 아무 일도 일어나지 않습니다. 그러나 선택한 룸을 변경한 후 대화가 다시 연결되면 (콘솔 메시지에서 볼 수 있듯이) 암호화를 사용 가능으로 설정합니다. 이것은 버그입니다. 체크박스를 바꾸면 대화가 다시 연결되도록 버그를 수정합니다.</p><iframe src="https://codesandbox.io/s/f3ygk9?file=%2FChatRoom.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><h3 class="anchor anchorWithStickyNavbar_LWe7" id="힌트-3">힌트<a class="hash-link" href="#힌트-3" title="제목으로 바로 가기">​</a></h3><p>linter 억제는 항상 의심스럽습니다. 버그가 될까요?</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="해답-3">해답<a class="hash-link" href="#해답-3" title="제목으로 바로 가기">​</a></h3><p>linter 억제를 제거하면 linter 오류가 나타납니다. 문제는 <code>createConnection</code>이 prop이기 때문에 reactive한 값이라는 것입니다. 시간이 지남에 따라 변경될 수 있습니다! (실제로 사용자가 체크박스를 선택하면 부모 컴포넌트가 <code>createConnection</code> prop의 다른 값을 전달합니다.) 이것이 의존성이어야 하는 이유입니다. 배열에 포함하여 버그를 수정합니다:</p><iframe src="https://codesandbox.io/s/wezb5n?file=%2FChatRoom.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p><code>createConnection</code>이 종속성인 것은 맞습니다. 그러나 누군가가 앱 컴포넌트를 편집하여 인라인 함수를 이 prop의 값으로 전달할 수 있기 때문에 이 코드는 약간 취약합니다. 이 경우 앱 컴포넌트가 다시 렌더링될 때마다 값이 달라지므로 Effect가 너무 자주 다시 동기화될 수 있습니다. 이 문제를 방지하려면 <code>isEncrypted</code>을 대신 전달할 수 있습니다:</p><iframe src="https://codesandbox.io/s/bq4voj?file=%2FChatRoom.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>이 버전에서는 <code>App</code> 컴포넌트가 함수 대신 boolean prop을 전달합니다. Effect 내에서 사용할 함수를 결정합니다. <code>createEncryptedConnection</code>와 <code>createUnencryptedConnection</code> 둘 다 컴포넌트 밖에서 선언되기 때문에 reactive하지 않고 종속성일 필요가 없습니다. 이에 대한 자세한 내용은 <a href="https://react.dev/learn/removing-effect-dependencies" target="_blank" rel="noopener noreferrer">Effect 종속성 제거</a>에서 확인할 수 있습니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-연속된-셀렉트박스-채우기">5. 연속된 셀렉트박스 채우기<a class="hash-link" href="#5-연속된-셀렉트박스-채우기" title="제목으로 바로 가기">​</a></h3><p>이 예시에서는 두 개의 셀렉트박스가 있습니다. 하나의 셀렉트박스에서 사용자는 행성을 선택할 수 있습니다. 다른 셀렉트박스를 통해 사용자는 해당 행성의 위치를 선택할 수 있습니다. 두 번째 셀렉트박스는 아직 작동하지 않습니다. 두번째 셀렉트 박스가 선택된 행성의 장소들을 보여주도록 하세요.</p><p>첫 번째 셀렉트박스의 작동 방식을 확인합니다. /planets API 호출의 결과로 <code>planetList</code> 상태를 채웁니다. 현재 선택한 행성의 ID는 <code>planetId</code> 상태 변수에 유지됩니다. <code>placeList</code> 상태 변수가 <code>&quot;/planets/&quot; + planetId + &quot;/places&quot;</code> API 호출의 결과로 채워지도록 코드를 추가할 위치를 찾아야 합니다.</p><p>이 권한을 적용할 경우 행성을 선택하면 플레이스 목록이 채워집니다. 행성을 변경하면 플레이스 목록이 변경됩니다.</p><iframe src="https://codesandbox.io/s/k1cdux?file=%2FApp.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><h3 class="anchor anchorWithStickyNavbar_LWe7" id="힌트-4">힌트<a class="hash-link" href="#힌트-4" title="제목으로 바로 가기">​</a></h3><p>두 개의 독립적인 동기화 프로세스가 있으면 두 개로 나눠진 Effect를 작성해야 합니다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="해답-4">해답<a class="hash-link" href="#해답-4" title="제목으로 바로 가기">​</a></h3><p>두 가지 독립적인 동기화 프로세스가 있습니다:</p><ul><li>첫 번째 셀렉트 박스는 원격 행성 목록에 동기화됩니다.</li><li>두 번째 셀렉트 박스는 현재 <code>planetId</code>에 대한 원격 위치 목록에 동기화됩니다.</li></ul><p>이것이 두 개의 개별 Effect로 설명하는 것이 타당한 이유입니다. 다음은 이러한 작업을 수행하는 방법의 예입니다:</p><iframe src="https://codesandbox.io/s/g3oym4?file=%2FApp.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>이 코드는 약간 반복적입니다. 하지만, 그것이 하나의 Effect로 결합해야하는 좋은 이유는 아닙니다! 이렇게 하면 Effect의 두 종속성을 하나의 목록으로 결합해야 합니다. 그런 다음 행성을 변경하면 모든 행성의 목록이 다시 가져옵니다. Effect는 코드 재사용을 위한 도구가 아닙니다.</p><p>대신 반복을 줄이기 위해 <code>useSelectOptions</code>와 같은 사용자 지정 Hook에 몇 가지 논리를 추출할 수 있습니다:</p><iframe src="https://codesandbox.io/s/lwkyjo?file=%2FApp.js&amp;utm_medium=sandpack" style="width:100%;height:500px;border:0;border-radius:4px;overflow:hidden" title="sandpack-project" allow="accelerometer; ambient-light-sensor; camera; encrypted-media; geolocation; gyroscope; hid; microphone; midi; payment; usb; vr; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-presentation allow-same-origin allow-scripts"></iframe><p>샌드박스에서 <code>useSelectOptions.js</code> 탭을 확인하여 작동 방식을 확인합니다. 이상적으로는 사용자가 작성하든 커뮤니티가 작성하든 간에 응용프로그램의 대부분의 Effect는 사용자 정의 hook으로 대체되어야 합니다. 사용자 지정 hook은 동기화 로직을 숨겨 호출 컴포넌트가 Effect를 알지 못하도록 합니다. 앱에서 작업을 계속하면서 선택할 수 있는 hook들을 개발하게 되고, 결국 컴포넌트에 Effect를 자주 기록할 필요가 없게 됩니다.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/line-next-level/React-Docs-KOR/tree/main/docs/learn/Escape Hatches/lifecycle-of-reactive-effects.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>페이지 편집</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="문서 탐색"><a class="pagination-nav__link pagination-nav__link--prev" href="/React-Docs-KOR/docs/learn/Escape Hatches/escape-hatches"><div class="pagination-nav__sublabel">이전</div><div class="pagination-nav__label">탈출구 (Advanced)</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/React-Docs-KOR/docs/learn/Escape Hatches/manipulating-the-dom-with-refs"><div class="pagination-nav__sublabel">다음</div><div class="pagination-nav__label">manipulating-the-dom-with-refs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#effect의-생명주기" class="table-of-contents__link toc-highlight">Effect의 생명주기</a><ul><li><a href="#왜-동기화는-1번-이상-일어날-필요가-있을까" class="table-of-contents__link toc-highlight">왜 동기화는 1번 이상 일어날 필요가 있을까</a></li><li><a href="#react가-effect를-재동기화하는-법" class="table-of-contents__link toc-highlight">React가 Effect를 재동기화하는 법</a></li><li><a href="#effect-관점으로-생각하기" class="table-of-contents__link toc-highlight">Effect 관점으로 생각하기</a></li><li><a href="#effect의-재동기화-여부를-react가-알아내는-방법" class="table-of-contents__link toc-highlight">Effect의 재동기화 여부를 React가 알아내는 방법</a></li><li><a href="#effect를-재동기화할-필요가-있다는-것을-react가-알아내는-법" class="table-of-contents__link toc-highlight">Effect를 재동기화할 필요가 있다는 것을 React가 알아내는 법</a></li><li><a href="#각각의-effect는-분리된-동기화-과정을-가집니다" class="table-of-contents__link toc-highlight">각각의 Effect는 분리된 동기화 과정을 가집니다</a></li></ul></li><li><a href="#effect는-reactive-값에-반응한다" class="table-of-contents__link toc-highlight">Effect는 reactive 값에 &#39;반응&#39;한다</a><ul><li><a href="#빈-배열을-가진-effect가-의미하는-것" class="table-of-contents__link toc-highlight">빈 배열을 가진 Effect가 의미하는 것</a></li></ul></li><li><a href="#컴포넌트의-body-영역에-선언되어있는-모든-변수들은-reactive-합니다" class="table-of-contents__link toc-highlight">컴포넌트의 body 영역에 선언되어있는 모든 변수들은 reactive 합니다.</a></li><li><a href="#react는-모든-reactive한-값을-종속성으로-지정했는-지-확인합니다" class="table-of-contents__link toc-highlight">React는 모든 reactive한 값을 종속성으로 지정했는 지 확인합니다.</a></li><li><a href="#재동기화를-원하지-않을-때-해야-할-것" class="table-of-contents__link toc-highlight">재동기화를 원하지 않을 때 해야 할 것</a></li><li><a href="#되짚어보기" class="table-of-contents__link toc-highlight">되짚어보기</a></li><li><a href="#도전해보기" class="table-of-contents__link toc-highlight">도전해보기</a><ul><li><a href="#1-모든-키-입력마다-다시-연결되는-것을-수정하기" class="table-of-contents__link toc-highlight">1. 모든 키 입력마다 다시 연결되는 것을 수정하기</a></li><li><a href="#힌트" class="table-of-contents__link toc-highlight">힌트</a></li><li><a href="#해답" class="table-of-contents__link toc-highlight">해답</a></li><li><a href="#2-스위치를-켜고-끄는-것을-동기화하기" class="table-of-contents__link toc-highlight">2. 스위치를 켜고 끄는 것을 동기화하기</a></li><li><a href="#힌트-1" class="table-of-contents__link toc-highlight">힌트</a></li><li><a href="#해답-1" class="table-of-contents__link toc-highlight">해답</a></li><li><a href="#3-오래된-값-오류를-조사하기" class="table-of-contents__link toc-highlight">3. 오래된 값 오류를 조사하기</a></li><li><a href="#힌트-2" class="table-of-contents__link toc-highlight">힌트</a></li><li><a href="#해답-2" class="table-of-contents__link toc-highlight">해답</a></li><li><a href="#4-스위치-연결-고치기" class="table-of-contents__link toc-highlight">4. 스위치 연결 고치기</a></li><li><a href="#힌트-3" class="table-of-contents__link toc-highlight">힌트</a></li><li><a href="#해답-3" class="table-of-contents__link toc-highlight">해답</a></li><li><a href="#5-연속된-셀렉트박스-채우기" class="table-of-contents__link toc-highlight">5. 연속된 셀렉트박스 채우기</a></li><li><a href="#힌트-4" class="table-of-contents__link toc-highlight">힌트</a></li><li><a href="#해답-4" class="table-of-contents__link toc-highlight">해답</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div></div></footer></div>
<script src="/React-Docs-KOR/assets/js/runtime~main.e4fc62bc.js"></script>
<script src="/React-Docs-KOR/assets/js/main.e1e3cefa.js"></script>
</body>
</html>